<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Counter Admin Panel</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .control-group {
        margin-bottom: 20px;
        padding: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      button {
        padding: 10px 20px;
        margin: 5px;
        cursor: pointer;
        font-size: 16px;
      }
      input[type="number"] {
        padding: 10px;
        font-size: 16px;
        width: 100px;
      }
    </style>
  </head>
  <body>
    <h2>üöÄ Live Counter Control</h2>

    <div class="control-group">
      <h3>Current Value (X) Control</h3>
      <p id="currentStatus">Current X: Loading...</p>
      <button onclick="changeScore(1)">+1</button>
      <button onclick="changeScore(-1)">-1</button>
      <button onclick="changeScore(10)">+10</button>
      <button onclick="changeScore(-10)">-10</button>
    </div>

    <div class="control-group">
      <h3>Target Value (Y) Control</h3>
      <p id="targetStatus">Current Y: Loading...</p>
      <input
        type="number"
        id="newTargetInput"
        placeholder="‡πÉ‡∏™‡πà‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà"
        value="10"
      />
      <button onclick="setNewTarget()">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà (Y)</button>
    </div>

    <div class="control-group">
      <h3>Reset</h3>
      <button onclick="resetAll()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï X & Y (X=0)</button>
    </div>

    <script>
      const BASE_URL = "https://servertiktokcounter.onrender.com"; // **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

      // ----------------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° X -----------------
      function changeScore(amount) {
        fetch(BASE_URL + "update_current", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ change: amount }),
        })
          .then((response) => {
            if (!response.ok) throw new Error("Update X failed");
            console.log(`Updated X by ${amount}`);
            updateStatusDisplay();
          })
          .catch((error) => console.error("Error updating score:", error));
      }

      // ----------------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Y -----------------
      function setNewTarget() {
        const newTarget = document.getElementById("newTargetInput").value;
        fetch(BASE_URL + "set_target", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ new_target: parseInt(newTarget) }),
        })
          .then((response) => {
            if (!response.ok) throw new Error("Update Y failed");
            console.log(`New Target (Y) set to ${newTarget}`);
            updateStatusDisplay();
          })
          .catch((error) => console.error("Error setting target:", error));
      }

      // ----------------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï -----------------
      function resetAll() {
        if (
          confirm(
            "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤ X ‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÅ‡∏•‡∏∞ Y ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô?"
          )
        ) {
          fetch(BASE_URL + "reset", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ current: 0 }), // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï X ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 0
          })
            .then((response) => {
              if (!response.ok) throw new Error("Reset failed");
              console.log("X reset to 0.");
              updateStatusDisplay();
            })
            .catch((error) => console.error("Error resetting:", error));
        }
      }

      // ----------------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô -----------------
      async function updateStatusDisplay() {
        try {
          const response = await fetch(BASE_URL + "status");
          const data = await response.json();
          document.getElementById(
            "currentStatus"
          ).textContent = `Current X: ${data.current}`;
          document.getElementById(
            "targetStatus"
          ).textContent = `Current Y: ${data.target}`;
        } catch (error) {
          document.getElementById("currentStatus").textContent =
            "Current X: API Error";
          document.getElementById("targetStatus").textContent =
            "Current Y: API Error";
        }
      }

      // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
      updateStatusDisplay();
      setInterval(updateStatusDisplay, 5000); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    </script>
  </body>
</html>
